(()=>{var __webpack_modules__=[e=>{"use strict";e.exports=require("@babel/runtime/helpers/extends")},e=>{"use strict";e.exports=require("@babel/runtime/helpers/asyncToGenerator")},e=>{"use strict";e.exports=require("@babel/runtime/regenerator")},e=>{"use strict";e.exports=require("clientnode")},e=>{"use strict";e.exports=require("fs")},e=>{"use strict";e.exports=require("path")},e=>{"use strict";e.exports=require("child_process")},e=>{"use strict";e.exports=require("pouchdb/node_modules/node-fetch/lib/index.js")},(module,__unused_webpack_exports,__webpack_require__)=>{(function(){"use strict";function __nested_webpack_require_25__(e){var _=__webpack_module_cache__[e];if(void 0!==_)return _.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__nested_webpack_require_25__),r.exports}var __webpack_modules__=[function(e){e.exports=__webpack_require__(0)},function(e){e.exports=__webpack_require__(1)},function(e){e.exports=__webpack_require__(2)},function(e){e.exports=__webpack_require__(3)},function(e){e.exports=__webpack_require__(4)},function(e){e.exports=__webpack_require__(5)},function(e){e.exports=__webpack_require__(6)},function(e){e.exports=__webpack_require__(7)}],__webpack_module_cache__={};__nested_webpack_require_25__.n=function(e){var _=e&&e.__esModule?function(){return e.default}:function(){return e};return __nested_webpack_require_25__.d(_,{a:_}),_},__nested_webpack_require_25__.d=function(e,_){for(var r in _)__nested_webpack_require_25__.o(_,r)&&!__nested_webpack_require_25__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:_[r]})},__nested_webpack_require_25__.o=function(e,_){return Object.prototype.hasOwnProperty.call(e,_)},__nested_webpack_require_25__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};(function(){function _createForOfIteratorHelperLoose(e,_){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||_&&e&&"number"==typeof e.length){r&&(e=r);var t=0;return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,_){if(e){if("string"==typeof e)return _arrayLikeToArray(e,_);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,_):void 0}}function _arrayLikeToArray(e,_){(null==_||_>e.length)&&(_=e.length);for(var r=0,t=Array(_);r<_;r++)t[r]=e[r];return t}__nested_webpack_require_25__.r(__webpack_exports__),__nested_webpack_require_25__.d(__webpack_exports__,{Helper:function(){return _Helper},default:function(){return __WEBPACK_DEFAULT_EXPORT__}});var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__=__nested_webpack_require_25__(0),_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default=__nested_webpack_require_25__.n(_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__=__nested_webpack_require_25__(1),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default=__nested_webpack_require_25__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2__=__nested_webpack_require_25__(2),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default=__nested_webpack_require_25__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2__),child_process__WEBPACK_IMPORTED_MODULE_3__=__nested_webpack_require_25__(6),child_process__WEBPACK_IMPORTED_MODULE_3___default=__nested_webpack_require_25__.n(child_process__WEBPACK_IMPORTED_MODULE_3__),clientnode__WEBPACK_IMPORTED_MODULE_4__=__nested_webpack_require_25__(3),clientnode__WEBPACK_IMPORTED_MODULE_4___default=__nested_webpack_require_25__.n(clientnode__WEBPACK_IMPORTED_MODULE_4__),node_fetch__WEBPACK_IMPORTED_MODULE_5__=__nested_webpack_require_25__(7),node_fetch__WEBPACK_IMPORTED_MODULE_5___default=__nested_webpack_require_25__.n(node_fetch__WEBPACK_IMPORTED_MODULE_5__),fs__WEBPACK_IMPORTED_MODULE_6__=__nested_webpack_require_25__(4),fs__WEBPACK_IMPORTED_MODULE_6___default=__nested_webpack_require_25__.n(fs__WEBPACK_IMPORTED_MODULE_6__),path__WEBPACK_IMPORTED_MODULE_7__=__nested_webpack_require_25__(5),path__WEBPACK_IMPORTED_MODULE_7___default=__nested_webpack_require_25__.n(path__WEBPACK_IMPORTED_MODULE_7__);clientnode__WEBPACK_IMPORTED_MODULE_4__.globalContext.fetch=node_fetch__WEBPACK_IMPORTED_MODULE_5___default();var _Helper=function(){function Helper(){}return Helper.getConnectorOptions=function(e){return e.couchdb.connector.fetch?{fetch:function(_,r){return clientnode__WEBPACK_IMPORTED_MODULE_4__.globalContext.fetch(_,clientnode__WEBPACK_IMPORTED_MODULE_4___default().extend(!0,clientnode__WEBPACK_IMPORTED_MODULE_4___default().copy(e.couchdb.connector.fetch),r||{}))}}:{fetch:function(e,_){return clientnode__WEBPACK_IMPORTED_MODULE_4__.globalContext.fetch(e,_)}}},Helper.mayStripRepresentation=function(e,_,r){var t=clientnode__WEBPACK_IMPORTED_MODULE_4___default().represent(e);return t.length<=_?t.length>r?t.substring(0,r-3)+"...":t:"DOCUMENT IS TOO BIG TO REPRESENT"},Helper.ensureValidationDocumentPresence=(a=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().mark((function e(_,r,t,n,o,a,c){var i,s,u;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===o&&(o=!0),void 0===a&&(a="_id"),void 0===c&&(c="_design/"),s=_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default()(((i={})[a]=""+c+r,i.language="javascript",i),t),e.prev=4,e.next=7,_.get(""+c+r);case 7:return u=e.sent,s._rev=u._rev,e.next=11,_.put(s);case 11:case 20:e.next=26;break;case 14:return e.prev=14,e.t0=e.catch(4),o&&e.t0.error,e.prev=17,e.next=20,_.put(s);case 23:throw e.prev=23,e.t1=e.catch(17),new Error(n+" couldn't be installed/updated: \""+clientnode__WEBPACK_IMPORTED_MODULE_4___default().represent(e.t1)+'".');case 26:case"end":return e.stop()}}),e,null,[[4,14],[17,23]])}))),function(){return a.apply(this,arguments)}),Helper.initializeConnection=function(){var e=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().mark((function e(_,r){var t,n,o,a,c,i;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=clientnode__WEBPACK_IMPORTED_MODULE_4___default().stringFormat(r.couchdb.url,r.couchdb.user.name+":"+r.couchdb.user.password+"@")+"/"+r.couchdb.databaseName,_.couchdb.connection=new _.couchdb.connector(t,Helper.getConnectorOptions(r)),_.couchdb.connection.setMaxListeners(1/0),n=r.couchdb.model.property.name.special.id,o=r.couchdb.model.property.name.special.revision,a=function(){var e=i.value,t=_.couchdb.connection[e].bind(_.couchdb.connection);_.couchdb.connection[e]=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().mark((function e(_){var a,c,i,s,u,l=arguments;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,a=l.length,c=Array(1<a?a-1:0),i=1;i<a;i++)c[i-1]=l[i];return e.next=4,t.apply(void 0,[_].concat(c));case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(0),!(n in _&&r.couchdb.ignoreNoChangeError&&"forbidden"===e.t0.name&&null!=(s=e.t0.message)&&s.startsWith("NoChange:"))){e.next=21;break}if(u={id:_[n],ok:!0},!(o in _)||["latest","upsert"].includes(_[o])){e.next=15;break}e.t1=_[o],e.next=19;break;case 15:return e.next=17,this.get(u.id);case 17:e.t2=o,e.t1=e.sent[e.t2];case 19:return u.rev=e.t1,e.abrupt("return",u);case 21:throw e.t0;case 22:case"end":return e.stop()}}),e,this,[[0,7]])})))},c=_createForOfIteratorHelperLoose(["post","put"]);!(i=c()).done;)a();return e.prev=7,e.next=10,clientnode__WEBPACK_IMPORTED_MODULE_4___default().checkReachability(t);case 10:e.next=17;break;case 12:return e.prev=12,e.t0=e.catch(7),e.next=17,clientnode__WEBPACK_IMPORTED_MODULE_4__.globalContext.fetch(t,{method:"PUT"});case 17:return e.abrupt("return",_);case 18:case"end":return e.stop()}}),e,null,[[7,12]])})));return function(){return e.apply(this,arguments)}}(),Helper.startServer=function(){function startServer(){return _startServer.apply(this,arguments)}var _startServer=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().mark((function _callee4(services,configuration){var _this=this;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().wrap((function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(!Object.prototype.hasOwnProperty.call(services.couchdb.server.runner,"configurationFile")){_context4.next=12;break}return _context4.prev=1,_context4.next=4,fs__WEBPACK_IMPORTED_MODULE_6__.promises.mkdir(path__WEBPACK_IMPORTED_MODULE_7___default().dirname(services.couchdb.server.runner.configurationFile.path),{recursive:!0});case 4:_context4.next=10;break;case 6:if(_context4.prev=6,_context4.t0=_context4.catch(1),"EEXIST"===_context4.t0.code){_context4.next=10;break}throw _context4.t0;case 10:return _context4.next=12,fs__WEBPACK_IMPORTED_MODULE_6__.promises.writeFile(services.couchdb.server.runner.configurationFile.path,services.couchdb.server.runner.configurationFile.content,{encoding:configuration.core.encoding});case 12:return services.couchdb.server.process=(0,child_process__WEBPACK_IMPORTED_MODULE_3__.spawn)("default"===configuration.couchdb.binary.memoryInMegaByte?services.couchdb.server.runner.binaryFilePath:configuration.couchdb.binary.nodePath,("default"===configuration.couchdb.binary.memoryInMegaByte?[]:["--max-old-space-size="+configuration.couchdb.binary.memoryInMegaByte,services.couchdb.server.runner.binaryFilePath]).concat(services.couchdb.server.runner.arguments?services.couchdb.server.runner.arguments:[]),{cwd:eval("process").cwd(),env:Object.prototype.hasOwnProperty.call(services.couchdb.server.runner,"environment")?_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default()({},eval("process").env,services.couchdb.server.runner.environment):eval("process").env,shell:!0,stdio:"inherit"}),new Promise((function(e,_){for(var r,t,n=_createForOfIteratorHelperLoose(clientnode__WEBPACK_IMPORTED_MODULE_4__.CloseEventNames);!(r=n()).done;)t=r.value,services.couchdb.server.process.on(t,clientnode__WEBPACK_IMPORTED_MODULE_4___default().getProcessCloseHandler(e,_,{process:services.couchdb.server.process,reason:t}))})).then((function(e){var _,r;null!=(_=services.couchdb)&&null!=(r=_.server)&&r.resolve&&services.couchdb.server.resolve.call(_this,e)}),(function(e){var _,r;null!=(_=services.couchdb)&&null!=(r=_.server)&&r.resolve&&services.couchdb.server.reject.call(_this,e)})),_context4.next=16,clientnode__WEBPACK_IMPORTED_MODULE_4___default().checkReachability(clientnode__WEBPACK_IMPORTED_MODULE_4___default().stringFormat(configuration.couchdb.url,""),{wait:!0});case 16:case"end":return _context4.stop()}}),_callee4,null,[[1,6]])})));return startServer}(),Helper.restartServer=function(){var e=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().mark((function e(_){var r,t,n,o,a,c;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=_.configuration,t=_.pluginAPI,n=_.services,o=n.couchdb.server,a=o.resolve,c=o.reject,o.resolve=o.reject=clientnode__WEBPACK_IMPORTED_MODULE_4___default().noop,e.next=7,Helper.stopServer(n,r);case 7:return o.resolve=a,o.reject=c,e.next=11,Helper.startServer(n,r);case 11:return Helper.initializeConnection(n,r),e.next=14,t.callStack(_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default()({},_,{hook:"restartCouchdb"}));case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Helper.stopServer=function(){var e=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().mark((function e(_,r){var t,n;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_2___default().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=_.couchdb,n=r.couchdb,t.connection&&t.connection.close(),t.server.process&&t.server.process.kill("SIGINT"),e.next=6,clientnode__WEBPACK_IMPORTED_MODULE_4___default().checkUnreachability(clientnode__WEBPACK_IMPORTED_MODULE_4___default().stringFormat(n.url,""),{wait:!0});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Helper.determineAllowedModelRolesMapping=function(e){for(var _=e.property.name.special.allowedRole,r={},t=Helper.extendModels(e),n=0,o=Object.entries(t);n<o.length;n++){var a=o[n],c=a[0],i=a[1];if(Object.prototype.hasOwnProperty.call(i,_)){r[c]=_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_0___default()({properties:{}},Helper.normalizeAllowedRoles(i[_]));for(var s=0,u=Object.entries(i);s<u.length;s++){var l=u[s],p=l[0],d=l[1];null!==d&&"object"==typeof d&&d.allowedRoles&&(r[c].properties[p]=Helper.normalizeAllowedRoles(d.allowedRoles))}}else r[c]={properties:{},read:[],write:[]}}return r},Helper.determineGenericIndexablePropertyNames=function(e,_){var r=e.property.name.special;return Object.keys(_).filter((function(t){return null!==_[t]&&"object"==typeof _[t]&&(Object.prototype.hasOwnProperty.call(_[t],"index")&&_[t].index||!(Object.prototype.hasOwnProperty.call(_[t],"index")&&!_[t].index||e.property.name.reserved.concat(r.additional,r.allowedRole,r.attachment,r.conflict,r.constraint.execution,r.constraint.expression,r.deleted,r.deletedConflict,r.extend,r.id,r.maximumAggregatedSize,r.minimumAggregatedSize,r.oldType,r.revision,r.revisions,r.revisionsInformation,r.type).includes(t)||_[t].type&&("string"==typeof _[t].type&&_[t].type.endsWith("[]")||Array.isArray(_[t].type)&&_[t].type.length&&Array.isArray(_[t].type[0])||Object.prototype.hasOwnProperty.call(e.entities,_[t].type))))})).concat(r.id,r.revision).sort()},Helper.extendModel=function(e,_,r){if(void 0===r&&(r="_extends"),"_base"===e)return _[e];if(Object.prototype.hasOwnProperty.call(_,"_base")&&(Object.prototype.hasOwnProperty.call(_[e],r)&&_[e][r]?_[e][r]=["_base"].concat(_[e][r]):_[e][r]="_base"),Object.prototype.hasOwnProperty.call(_[e],r)){for(var t,n,o=_createForOfIteratorHelperLoose([].concat(_[e][r]));!(t=o()).done;)n=t.value,_[e]=clientnode__WEBPACK_IMPORTED_MODULE_4___default().extend(!0,clientnode__WEBPACK_IMPORTED_MODULE_4___default().copy(Helper.extendModel(n,_,r)),_[e]);delete _[e][r]}return _[e]},Helper.extendModels=function(e){for(var _,r=e.property.name.special,t={},n=0,o=Object.keys(e.entities);n<o.length;n++){if(_=o[n],!new RegExp(e.property.name.typeRegularExpressionPattern.public).test(_)&&!new RegExp(e.property.name.typeRegularExpressionPattern.private).test(_))throw new Error('Model names have to match "'+e.property.name.typeRegularExpressionPattern.public+'" or "'+e.property.name.typeRegularExpressionPattern.private+'" for private one (given name: "'+_+'").');t[_]=Helper.extendModel(_,e.entities,r.extend)}for(var a,c=0,i=Object.values(t);c<i.length;c++){a=i[c];for(var s=0,u=Object.entries(a);s<u.length;s++){var l=u[s],p=l[0],d=l[1];if(p===r.attachment)for(var b=0,E=Object.entries(d);b<E.length;b++){var f=E[b],O=f[0],P=f[1];d[O]=clientnode__WEBPACK_IMPORTED_MODULE_4___default().extend(!0,clientnode__WEBPACK_IMPORTED_MODULE_4___default().copy(e.property.defaultSpecification),P)}else[r.allowedRole,r.constraint.execution,r.constraint.expression,r.extend,r.maximumAggregatedSize,r.minimumAggregatedSize,r.oldType].includes(p)||(a[p]=clientnode__WEBPACK_IMPORTED_MODULE_4___default().extend(!0,clientnode__WEBPACK_IMPORTED_MODULE_4___default().copy(e.property.defaultSpecification),d))}}return t},Helper.normalizeAllowedRoles=function(e){if(Array.isArray(e))return{read:e,write:e};if("object"==typeof e){for(var _,r={read:[],write:[]},t=0,n=Object.keys(r);t<n.length;t++)_=n[t],Object.prototype.hasOwnProperty.call(e,_)&&(Array.isArray(e[_])?r[_]=e[_]:r[_]=[e[_]]);return r}return{read:[e],write:[e]}},Helper;var a}(),__WEBPACK_DEFAULT_EXPORT__=_Helper})(),module.exports=__webpack_exports__})()}],__webpack_module_cache__={};function __webpack_require__(e){var _=__webpack_module_cache__[e];if(void 0!==_)return _.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__webpack_require__),r.exports}var __webpack_exports__=__webpack_require__(8);module.exports=__webpack_exports__})();