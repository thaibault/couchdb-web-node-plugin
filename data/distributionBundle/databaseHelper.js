(()=>{var e=[e=>{!function(){"use strict";function t(){return(t=r()?Reflect.construct.bind():function(e,t,r){var o=[null];o.push.apply(o,t);var a=new(Function.bind.apply(e,o));return r&&n(a,r.prototype),a}).apply(null,arguments)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},o.apply(this,arguments)}function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var l={d:function(e,t){for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},c={};l.r(c),l.d(c,{DatabaseHelper:function(){return p},default:function(){return s}});var p=function(){function e(){}return e.authenticate=function(e,t,r,n,o,i,l,c,p){var s;void 0===t&&(t=null),void 0===r&&(r={}),void 0===n&&(n={admins:{names:[],roles:[]},members:{names:[],roles:[]}}),void 0===i&&(i="_id"),void 0===l&&(l="-type"),void 0===c&&(c="_design/"),void 0===p&&(p=!1);var u=null!==(s=e[l])&&void 0!==s?s:t&&t[l];if(!u)return!0;var m=p?"read":"write",y={properties:{},read:["_admin","readonlyadmin"],write:["_admin"]};Object.prototype.hasOwnProperty.call(e,i)&&e[i].startsWith(c)&&y.read.push("readonlymember");var d,f="Current user doesn't own any role";if(r)if("name"in r||(r.name='"unknown"'),null!=(d=r.roles)&&d.length){if(o&&u&&Object.prototype.hasOwnProperty.call(o,u)){for(var h,g,v=o[u],O=a(["read","write"]);!(h=O()).done;)y[g=h.value]=y[g].concat(v[g]||[]);y.properties=v.properties}for(var b,w,P=y[m],j=a(r.roles);!(b=j()).done;)if(w=b.value,P.includes(w))return!0;f='Current user "'+r.name+'" owns the following roles: "'+r.roles.join('", "')+'"'}else f='Current user "'+r.name+"\" doesn't own any role";throw{unauthorized:"Only users with a least on of these roles are allowed to perform requested "+m+' action: "'+[].concat(y[m]).join('", "')+'". '+f+"."}},e.validateDocumentUpdate=function(e,r,n,i,l,c,p){void 0===c&&(c={});var s=function(e,t,r){var n;void 0===t&&(t="forbidden"),void 0===r&&(r={});for(var o=((n={})[t]=e,n.message=e,n.name=t,n),a=0,i=Object.entries(r);a<i.length;a++){var l=i[a],c=l[0],p=l[1];o[c]=p}throw o},u=new Date,m=Date.UTC(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate(),u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds())/1e3,y=!l.dateTimeFormat.startsWith("iso"),d=l.property.name.special,f=d.id,h=d.revision,g=d.type;r&&r[g]&&!e[g]&&(e[g]=r[g]);var v="",O="",b=function(){v=Object.prototype.hasOwnProperty.call(e,f)?e[f]:"",O=Object.prototype.hasOwnProperty.call(e,h)?e[h]:""};if(b(),Object.prototype.hasOwnProperty.call(i,l.property.name.validatedDocumentsCache)&&i[l.property.name.validatedDocumentsCache].has(v+"-"+O))return i[l.property.name.validatedDocumentsCache].delete(v+"-"+O),e;["latest","upsert"].includes(O)&&(r&&Object.prototype.hasOwnProperty.call(r,h)?O=e[h]=r[h]:"latest"===O?s("Revision: No old document available to update."):delete e[h]);var w=l.updateStrategy;Object.prototype.hasOwnProperty.call(e,d.strategy)&&(w=e[d.strategy],delete e[d.strategy]);var P,j={};if("migrate"===w)for(var x=0,N=Object.entries(c);x<N.length;x++){var A=N[x],C=A[0],S=A[1];if(Object.prototype.hasOwnProperty.call(S,d.oldType)&&![null,void 0].includes(S[d.oldType]))for(var k,T,E=a([].concat(S[d.oldType]));!(k=E()).done;)T=k.value,j[T]=C}p?P=p:JSON&&Object.prototype.hasOwnProperty.call(JSON,"stringify")?P=function(e){return JSON.stringify(e,null,4)}:s('Needed "serializer" is not available.');var D=[d.additional,d.allowedRole,d.constraint.execution,d.constraint.expression,d.create.execution,d.create.expression,d.extend,d.maximumAggregatedSize,d.minimumAggregatedSize,d.oldType,d.update.execution,d.update.expression],z=function(e){return e instanceof Error?""+e:P(e)},R=function(e){return"string"==typeof e?e.trim():""},M=function(e){if(y)null!==e&&"number"!=typeof e&&(e=new Date(e),e=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())/1e3);else if(null!==e){e=new Date("number"!=typeof e||isNaN(e)?e:1e3*e);try{e=e.toISOString()}catch(e){}}return e},U=function(e,t,r){if(r.fileName){if(r.fileName.value)return r.fileName.value===t;if(r.fileName.regularExpressionPattern)return new RegExp(r.fileName.regularExpressionPattern).test(t)}return e===t},_=function(t,r){if(r||(r=e[d.attachment]),t){for(var n,o=0,a=Object.keys(r);o<a.length;o++)if((n=a[o]).startsWith(t))return n}else{var i=Object.keys(r);if(i.length)return i[0]}return null},H=function(e,r,n){void 0===r&&(r=!1),void 0===n&&(n={});var a=R(e);if(a){var i,l=(r?"return ":"")+a,c=o({},I,{code:l},n),p=Object.keys(c);try{i=t(Function,p.concat([l]))}catch(e){s(z(e),"compilation",{code:l,error:e,scope:c})}var u={code:l,result:void 0,scope:c};try{u.result=i.apply(void 0,p.map((function(e){return c[e]})))}catch(e){s(z(e),"runtime",{code:l,error:e,scope:c})}return u}s("No expression to evaluate provided.","empty")},L=function(e,r,n){void 0===n&&(n=[]);var o=n.length?" in "+n.join(" -> "):"",i=[],p=function(){Object.prototype.hasOwnProperty.call(e,g)||(r&&Object.prototype.hasOwnProperty.call(r,g)&&["fillUp","migrate"].includes(w)?e[g]=r[g]:s('Type: You have to specify a model type via property "'+g+'"'+o+".")),n.length||new RegExp(l.property.name.typeRegularExpressionPattern.public).test(e[g])||s('TypeName: You have to specify a model type which matches "'+l.property.name.typeRegularExpressionPattern.public+'" as public type (given "'+e[g]+'")'+o+"."),Object.prototype.hasOwnProperty.call(c,e[g])||(Object.prototype.hasOwnProperty.call(j,e[g])?e[g]=j[e[g]]:s('Model: Given model "'+e[g]+'" is not specified'+o+"."))};p();var u=e[g],m=c[u],v=null;Object.prototype.hasOwnProperty.call(m,d.additional)&&m[d.additional]&&(v=m[d.additional]);var O=function i(l,c,p,y,d){void 0===d&&(d=["constraintExecution","constraintExpression"]);for(var f,h,g=a(d);!(f=g()).done;)if(h=f.value,Object.prototype.hasOwnProperty.call(p,h)){var v,O=void 0;try{O=H(p[h].evaluation,h.endsWith("Expression"),{checkPropertyContent:i,model:m,modelName:u,name:c,type:h,newDocument:e,newValue:l,oldDocument:r,oldValue:y,parentNames:n,pathDescription:o,propertySpecification:p})}catch(c){if(function(e){return Object.prototype.hasOwnProperty.call(e,"compilation")}(c)&&s('Compilation: Hook "'+h+'" has invalid code "'+c.code+'": "'+c.message+'"'+o+"."),function(e){return Object.prototype.hasOwnProperty.call(e,"runtime")}(c)&&s('Runtime: Hook "'+h+'" has throw an error with code "'+c.code+'": "'+c.message+'"'+o+"."),!Object.prototype.hasOwnProperty.call(c,"empty"))throw c}if(null==(v=O)||!v.result){var b=R(p[h].description);s(h.charAt(0).toUpperCase()+(h.substring(1)+": ")+(b?t(Function,Object.keys(O.scope).concat(["return "+b])).apply(void 0,Object.values(O.scope)):'Property "'+c+'" should satisfy constraint "'+O.code+'" (given "'+z(l)+'")'+o+"."))}}},P=function(e,t,r,i){void 0===i&&(i=null);var l=[],p=[].concat(r.type?r.type:[]);"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&!Object.prototype.hasOwnProperty.call(e,g)&&1===p.length&&Object.prototype.hasOwnProperty.call(c,p[0])&&(e[g]=p[0]);for(var u,m,d=!1,h=a(p);!(u=h()).done;)if(m=u.value,Object.prototype.hasOwnProperty.call(c,m)){if("object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Object.prototype.hasOwnProperty.call(e,g)&&e[g]!==m&&"migrate"===w&&1===p.length&&(e[g]=m,l=n.concat(t,"migrate nested object type")),"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&Object.prototype.hasOwnProperty.call(e,g)&&e[g]===m){var v=L(e,i,n.concat(t));if(v.changedPath.length&&(l=v.changedPath),e=v.newDocument,z(e)===z({}))return{newValue:null,changedPath:l};d=!0;break}1===p.length&&s('NestedType: Under key "'+t+'" isn\'t of type "'+m+'" (given "'+z(e)+'" of type '+typeof e+")"+o+".")}else if("DateTime"===m){var b=e;if(e=M(e),!(y&&("number"!=typeof e||isNaN(e))||!y&&"string"!=typeof e)){d=!0;break}1===p.length&&s('PropertyType: Property "'+t+'" isn\'t of (valid) type "DateTime" (given "'+z(b).replace(/^"/,"").replace(/"$/,"")+'" of type "'+typeof b+'")'+o+".")}else if(["boolean","integer","number","string"].includes(m)){if(!("number"==typeof e&&isNaN(e)||"integer"!==m&&typeof e!==m||"integer"===m&&parseInt(e,10)!==e)){d=!0;break}1===p.length&&s('PropertyType: Property "'+t+'" isn\'t of (valid) type "${type}" (given "'+z(e)+'" of type "'+typeof e+'")'+o+".")}else if("string"==typeof m&&m.startsWith("foreignKey:")){var P=c[m.substring(11)][f].type;if(P===typeof e){d=!0;break}1===p.length&&s('PropertyType: Foreign key property "'+t+'" isn\'t of type "'+P+'" (given "'+z(e)+'" of type "'+typeof e+'")'+o+".")}else{if("any"===m||z(e)===z(m)){d=!0;break}1===p.length&&s('PropertyType: Property "'+t+'" isn\'t value "'+m+'" (given "'+z(e).replace(/^"/,"").replace(/"$/,"")+'" of type "'+typeof e+'")'+o+".")}if(d||s('PropertyType: None of the specified types "'+p.join('", "')+'" for property "'+t+'" matches value "'+z(e).replace(/^"/,"").replace(/"$/,"")+e+'" of type "'+typeof e+'")'+o+"."),"string"==typeof e&&(![null,void 0].includes(r.minimumLength)&&e.length<r.minimumLength&&s('MinimalLength: Property "'+t+'" must have minimal length '+r.minimumLength+" (given "+e+" with length i"+e.length+") "+o+"."),![null,void 0].includes(r.maximumLength)&&e.length>r.maximumLength&&s('MaximalLength: Property "'+t+'" must have maximal length '+r.maximumLength+" (given "+e+" with length "+e.length+")"+o+".")),"number"==typeof e&&(![null,void 0].includes(r.minimum)&&e<r.minimum&&s('Minimum: Property "'+t+'" (type '+r.type+") must satisfy a minimum of "+r.minimum+" (given "+e+" is too low)"+o+"."),![null,void 0].includes(r.maximum)&&e>r.maximum&&s('Maximum: Property "'+t+'" (type '+r.type+") must satisfy a maximum of "+r.maximum+" (given "+e+" is too high)"+o+".")),r.selection){var j=Array.isArray(r.selection)?r.selection.map((function(e){return void 0===(null==e?void 0:e.value)?e:e.value})):Object.keys(r.selection);"DateTime"===r.type&&(j=j.map(M)),j.includes(e)||s('Selection: Property "'+t+'" (type '+r.type+') should be one of "'+j.join('", "')+'". But is "'+e+'"'+o+".")}return[null,void 0].includes(r.regularExpressionPattern)||new RegExp(r.regularExpressionPattern).test(e)?![null,void 0].includes(r.invertedRegularExpressionPattern)&&new RegExp(r.invertedRegularExpressionPattern).test(e)&&s('InvertedPatternMatch: Property "'+t+'" should not match regular expression pattern '+r.invertedRegularExpressionPattern+' (given "'+e+'")'+o+"."):s('PatternMatch: Property "'+t+'" should match regular expression pattern '+r.regularExpressionPattern+' (given "'+e+'")'+o+"."),O(e,t,r,i),z(e)!==z(i)&&(l=n.concat(t,"value updated")),{newValue:e,changedPath:l}},x=function(e,t,r,o,a){var c=t[o];if(!e.writable)if(r){if(Object.prototype.hasOwnProperty.call(r,o)&&z(c)===z(r[o]))return o!==f&&"incremental"===w&&delete t[o],!0;s('Readonly: Property "'+o+'" is not writable (old document "'+z(r)+'")'+a+".")}else s('Readonly: Property "'+o+'" is not writable'+a+".");if(!e.mutable&&r&&Object.prototype.hasOwnProperty.call(r,o)){if(z(c)===z(r[o]))return"incremental"!==w||l.property.name.reserved.concat(d.deleted,f,h).includes(o)||delete t[o],!0;"migrate"!==w&&s('Immutable: Property "'+o+'" is not writable (old document "'+z(r)+'")'+a+".")}if(null===c){if(e.nullable)return delete t[o],r&&Object.prototype.hasOwnProperty.call(r,o)&&(i=n.concat(o,"delete property")),!0;s('NotNull: Property "'+o+'" should not be "null"'+a+".")}return!1},N=function(e,t,r,i){if(!r)for(var l,c,p=a(["onCreateExecution","onCreateExpression"]);!(l=p()).done;)if(c=l.value,Object.prototype.hasOwnProperty.call(e,c)){var y=void 0;try{y=H(e[c],c.endsWith("Expression"),{checkPropertyContent:P,model:m,modelName:u,name:i,type:c,newDocument:t,oldDocument:r,newValue:void 0,oldValue:void 0,parentNames:n,pathDescription:o,propertySpecification:e})}catch(l){if(function(e){return Object.prototype.hasOwnProperty.call(e,"compilation")}(l)&&s('Compilation: Hook "'+c+'" has invalid code "'+l.code+'" for property "'+i+'": '+l.message+o+"."),function(e){return Object.prototype.hasOwnProperty.call(e,"runtime")}(l)&&s('Runtime: Hook "'+c+'" has throw an error with code "'+l.code+'" for property "'+i+'": '+l.message+o+"."),!Object.prototype.hasOwnProperty.call(l,"empty"))throw l}y&&![null,void 0].includes(y.result)&&(t[i]=y.result)}},A=function(e,t,r,i){if(Object.prototype.hasOwnProperty.call(t,i)){e.trim&&"string"==typeof t[i]&&(t[i]=t[i].trim()),e.emptyEqualsToNull&&(""===t[i]||Array.isArray(t[i])&&0===t[i].length||null!==t[i]&&"object"==typeof t[i]&&0===Object.keys(t).length)&&(t[i]=null);for(var l,c,p=a(["onUpdateExecution","onUpdateExpression"]);!(l=p()).done;)if(c=l.value,Object.prototype.hasOwnProperty.call(e,c))try{t[i]=H(e[c],c.endsWith("Expression"),{checkPropertyContent:P,model:m,modelName:u,name:i,type:c,newDocument:t,oldDocument:r,newValue:t[i],oldValue:r&&r[i],parentNames:n,pathDescription:o,propertySpecification:e}).result}catch(l){if(function(e){return Object.prototype.hasOwnProperty.call(e,"compilation")}(l)&&s('Compilation: Hook "'+c+'" has invalid code "'+l.code+'" for property "'+i+'": '+l.message+o+"."),function(e){return Object.prototype.hasOwnProperty.call(e,"runtime")}(l)&&s('Runtime: Hook "'+c+'" has throw an error with code "'+l.code+'" for property "'+i+'": '+l.message+o+"."),!Object.prototype.hasOwnProperty.call(l,"empty"))throw l}}},C=Object.keys(m).filter((function(e){return!D.includes(e)}));if("migrate"===w)for(var S,k,T=a(C);!(S=T()).done;)if(k=S.value,![null,void 0].includes(m[k].oldName))for(var E,_,I=a([].concat(m[k].oldName));!(E=I()).done;)_=E.value,Object.prototype.hasOwnProperty.call(e,_)&&(e[k]=e[_],delete e[_]);if(!r)for(var W,V=0,F=[d.create.execution,d.create.expression];V<F.length;V++)if(W=F[V],Object.prototype.hasOwnProperty.call(m,W)){var B=void 0;try{B=H(m[W],W.endsWith("Expression"),{checkPropertyContent:P,model:m,modelName:u,type:W,newDocument:e,oldDocument:r,parentNames:n,pathDescription:o}).result}catch(e){if(function(e){return Object.prototype.hasOwnProperty.call(e,"compilation")}(e)&&s('Compilation: Hook "'+W+'" has invalid code "'+e.code+'" for document "'+u+'": '+e.message+o+"."),function(e){return Object.prototype.hasOwnProperty.call(e,"runtime")}(e)&&s('Runtime: Hook "'+W+'" has throw an error with code "'+e.code+'" for document "'+u+'": '+e.message+o+"."),!Object.prototype.hasOwnProperty.call(e,"empty"))throw e}[null,void 0].includes(B)||(e=B),p(),u=e[g],0===n.length&&b()}for(var $,q=0,Y=[d.update.execution,d.update.expression];q<Y.length;q++)if($=Y[q],Object.prototype.hasOwnProperty.call(m,$)){var J=void 0;try{J=H(m[$],$.endsWith("Expression"),{checkPropertyContent:P,model:m,modelName:u,type:$,newDocument:e,oldDocument:r,parentNames:n,pathDescription:o}).result}catch(e){if(function(e){return Object.prototype.hasOwnProperty.call(e,"compilation")}(e)&&s('Compilation: Hook "'+$+'" has invalid code "'+e.code+'" for document "'+u+'": '+e.message+o+"."),function(e){return Object.prototype.hasOwnProperty.call(e,"runtime")}(e)&&s('Runtime: Hook "'+$+'" has throw an error with code "'+e.code+'" for document "'+u+'": '+e.message+o+"."),!Object.prototype.hasOwnProperty.call(e,"empty"))throw e}[void 0,null].includes(J)||(e=J),p(),u=e[g],0===n.length&&b()}for(var G,K=function(){var t=G.value;if(d.attachment===t)for(var l=function(){var l=p[c],u=l[0],m=l[1];Object.prototype.hasOwnProperty.call(e,t)&&null!==e[t]||(e[t]={}),r&&!Object.prototype.hasOwnProperty.call(r,t)&&(r[t]={});var y=Object.keys(e[t]).filter((function(r){return null!==e[t][r].data&&U(u,r,m)})),d=e[t],f=[];if(r){var h=r[t];f=Object.keys(h).filter((function(e){return!(Object.prototype.hasOwnProperty.call(d,e)&&Object.prototype.hasOwnProperty.call(d[e],"data")&&null===d[e].data)&&!!h[e]&&(Object.prototype.hasOwnProperty.call(h[e],"data")&&null!==h[e].data||h[e].stub&&!!h[e].digest)&&!!U(u,e,m)}))}for(var g,v,O=m,b=a(y);!(g=b()).done;)v=g.value,N(O,d,r&&r[t]?r[t]:null,v);for(var P,j,x=a(y);!(P=x()).done;)j=P.value,A(O,d,r&&r[t]?r[t]:null,j);if([null,void 0].includes(O.default)){if(O.nullable||0<y.length||0<f.length||s('AttachmentMissing: Missing attachment for type "'+u+'"'+o+"."),"fillUp"===w&&0===y.length&&0<f.length)for(var C,S,k=a(f);!(C=k()).done;)S=C.value,null===d[S]?i=n.concat(t,S,"file removed"):d[S]=r[t][S]}else if(0===y.length)if(0===f.length)for(var T in O.default)Object.prototype.hasOwnProperty.call(O.default,T)&&(d[T]=O.default[T],i=n.concat(t,u,"add default file"));else if("fillUp"===w)for(var E,D,z=a(f);!(E=z()).done;)D=E.value,d[D]=r[t][D]},c=0,p=Object.entries(m[t]);c<p.length;c++)l();else{var u=C.includes(t)?m[t]:v;N(u,e,r,t),A(u,e,r,t),[null,void 0].includes(u.default)?(!(u.nullable||Object.prototype.hasOwnProperty.call(e,t)||r&&Object.prototype.hasOwnProperty.call(r,t)&&w)&&s('MissingProperty: Missing property "'+t+'"'+o+"."),!Object.prototype.hasOwnProperty.call(e,t)&&r&&Object.prototype.hasOwnProperty.call(r,t)&&("fillUp"===w?e[t]=r[t]:!w&&(i=n.concat(t,"property removed")))):(!Object.prototype.hasOwnProperty.call(e,t)||null===e[t])&&(r&&Object.prototype.hasOwnProperty.call(r,t)?"fillUp"===w?e[t]=r[t]:"migrate"===w&&(e[t]=u.default,i=n.concat(t,"migrate default value")):(e[t]=u.default,i=i.concat(t,"add default value")))}},Z=a(C.concat(v?Object.keys(e).filter((function(e){return!C.includes(e)})):[]));!(G=Z()).done;)K();if(r&&"incremental"===w)for(var Q=0,X=Object.entries(e);Q<X.length;Q++){var ee=X[Q],te=ee[0],re=ee[1];!Object.prototype.hasOwnProperty.call(r,te)||l.property.name.reserved.concat(f,h,d.conflict,d.deleted,d.deletedConflict,d.localSequence,d.revisions,d.revisionsInformation,g).includes(te)||r[te]!==re&&z(r[te])!==z(re)||delete e[te]}for(var ne=0,oe=Object.entries(e);ne<oe.length;ne++){var ae=oe[ne],ie=ae[0],le=ae[1];if(!l.property.name.reserved.concat(h,d.conflict,d.deleted,d.deletedConflict,d.localSequence,d.revisions,d.revisionsInformation,d.strategy).includes(ie)){var ce=void 0;if(Object.prototype.hasOwnProperty.call(m,ie))ce=m[ie];else if(v)ce=v;else{if("migrate"===w){delete e[ie],i=n.concat(ie,"migrate removed property");continue}s('Property: Given property "'+ie+'" isn\'t specified in model "'+u+'"'+o+".")}if(!ce)continue;if(d.attachment===ie){var pe=le;for(var se in pe)if(Object.prototype.hasOwnProperty.call(pe,se))for(var ue in m[ie])if(U(ue,se,m[ie][ue])){x(m[ie][ue],e,r,se,o);break}continue}if(x(ce,e,r,ie,o))continue;if("string"==typeof ce.type&&ce.type.endsWith("[]")||Array.isArray(ce.type)&&ce.type.length&&Array.isArray(ce.type[0])){var me,ye=le;Array.isArray(ye)?![null,void 0].includes(ce.minimumNumber)&&ye.length<ce.minimumNumber?s('MinimumArrayLength: Property "'+ie+'" (array of length '+ye.length+") doesn't fullfill minimum array length of "+ce.minimumNumber+o+"."):![null,void 0].includes(ce.maximumNumber)&&ce.maximumNumber<ye.length&&s('MaximumArrayLength: Property "'+ie+'" (array of length '+ye.length+") doesn't fullfill maximum array length of "+ce.maximumNumber+o+"."):s('PropertyType: Property "'+ie+'" isn\'t of type "array -> '+ce.type+'" (given "'+z(ye)+'")'+o+"."),O(ye,ie,ce,r&&Object.prototype.hasOwnProperty.call(r,ie)&&r[ie]||void 0,["arrayConstraintExecution","arrayConstraintExpression"]);var de={};for(var fe in ce)Object.prototype.hasOwnProperty.call(ce,fe)&&(de[fe]="type"===fe?Array.isArray(ce[fe])?ce[fe][0]:[ce[fe].substring(0,ce.type.length-2)]:ce[fe]);if(1===(null==(me=de.type)?void 0:me.length)&&Object.prototype.hasOwnProperty.call(c,de.type[0]))for(var he,ge,ve=a(ye.slice());!(he=ve()).done;)"object"!=typeof(ge=he.value)||Object.getPrototypeOf(ge)!==Object.prototype||Object.prototype.hasOwnProperty.call(ge,g)||(ge[g]=de.type[0]);for(var Oe,be,we=0,Pe=a(ye.slice());!(Oe=Pe()).done;)be=Oe.value,ye[we]=P(be,we+1+". value in "+ie,de).newValue,null===be&&ye.splice(we,1),we+=1;r&&Object.prototype.hasOwnProperty.call(r,ie)&&Array.isArray(r[ie])&&r[ie].length===ye.length&&z(r[ie])===z(ye)||(i=n.concat(ie,"array updated"))}else{var je=r&&Object.prototype.hasOwnProperty.call(r,ie)?r[ie]:null,xe=P(le,ie,ce,je);e[ie]=xe.newValue,xe.changedPath.length&&(i=xe.changedPath),null===e[ie]&&(null!==je&&(i=n.concat(ie,"property removed")),delete e[ie])}}}for(var Ne,Ae=0,Ce=Object.keys(d.constraint);Ae<Ce.length;Ae++)if(Ne=Ce[Ae],(Ne=d.constraint[Ne])&&Object.prototype.hasOwnProperty.call(m,Ne))for(var Se,ke=a([].concat(m[Ne]));!(Se=ke()).done;){var Te,Ee=Se.value,De=void 0;try{De=H(Ee.evaluation,Ne===d.constraint.expression,{checkPropertyContent:P,model:m,modelName:u,type:Ne,newDocument:e,oldDocument:r,parentNames:n,pathDescription:o})}catch(e){if(function(e){return Object.prototype.hasOwnProperty.call(e,"compilation")}(e)&&s('Compilation: Hook "'+Ne+'" has invalid code "'+e.code+'": "'+e.message+'"'+o+"."),function(e){return Object.prototype.hasOwnProperty.call(e,"runtime")}(e)&&s('Runtime: Hook "'+Ne+'" has thrown an error with code "'+e.code+'": '+e.message+o+"."),!Object.prototype.hasOwnProperty.call(e,"empty"))throw e}if(null==(Te=De)||!Te.result){var ze=Ne.replace(/^[^a-zA-Z]+/,"");s(ze.charAt(0).toUpperCase()+(ze.substring(1)+": ")+(Ee.description?t(Function,Object.keys(De.scope).concat(["return "+Ee.description.trim()])).apply(void 0,Object.values(De.scope)):'Model "'+u+'" should satisfy constraint "'+De.code+'" (given "'+z(e)+'")'+o+"."))}}if(Object.prototype.hasOwnProperty.call(e,d.attachment)){var Re=e[d.attachment];("object"!=typeof Re||Object.getPrototypeOf(Re)!==Object.prototype)&&s("AttachmentType: given attachment has invalid type"+o+".");var Me=null;if(r&&Object.prototype.hasOwnProperty.call(r,d.attachment)&&null!==(Me=r[d.attachment])&&"object"==typeof Me)for(var Ue=0,_e=Object.entries(Me);Ue<_e.length;Ue++){var He=_e[Ue],Le=He[0],Ie=He[1];if(Object.prototype.hasOwnProperty.call(Re,Le)){var We=Re[Le];null===We||null===We.data||We.content_type===Ie.content_type&&(We.data===Ie.data||We.digest===Ie.digest)?((null===We||null===We.data)&&(i=n.concat(d.attachment,Le,"attachment removed")),"incremental"===w&&delete Re[Le]):i=n.concat(d.attachment,Le,"attachment updated")}else"fillUp"===w?Re[Le]=Ie:w||(i=n.concat(d.attachment,Le,"attachment removed"))}for(var Ve=0,Fe=Object.entries(Re);Ve<Fe.length;Ve++){var Be=Fe[Ve],$e=Be[0],qe=Be[1];[null,void 0].includes(qe)||null===qe.data?delete Re[$e]:(!Me||!Object.prototype.hasOwnProperty.call(Me,$e)||qe.content_type!==Me[$e].content_type||qe.data!==Me[$e].data&&qe.digest!==Me[$e].digest)&&(i=n.concat(d.attachment,$e,"attachment updated"))}0===Object.keys(Re).length&&delete e[d.attachment];for(var Ye={},Je=0,Ge=Object.keys(m[d.attachment]);Je<Ge.length;Je++)Ye[Ge[Je]]=[];for(var Ke=0,Ze=Object.keys(Re);Ke<Ze.length;Ke++){for(var Qe=Ze[Ke],Xe=!1,et=0,tt=Object.entries(m[d.attachment]);et<tt.length;et++){var rt=tt[et],nt=rt[0],ot=rt[1];if(U(nt,Qe,ot)){Ye[nt].push(Qe),Xe=!0;break}}Xe||s('AttachmentTypeMatch: None of the specified attachment types ("'+Object.keys(m[d.attachment]).join('", "')+'") matches given one ("'+Qe+'")'+o+".")}for(var at=0,it=0,lt=Object.keys(Ye);it<lt.length;it++){var ct=lt[it],pt=m[d.attachment][ct];if(Object.prototype.hasOwnProperty.call(Ye,ct)){var st=Ye[ct].length;null!==pt.maximumNumber&&st>pt.maximumNumber&&s("AttachmentMaximum: given number of attachments ("+st+") doesn't satisfy specified maximum of "+pt.maximumNumber+' from type "'+ct+'"'+o+"."),(!pt.nullable||0!==st)&&st<pt.minimumNumber&&s("AttachmentMinimum: given number of attachments ("+st+") doesn't satisfy specified minimum of "+pt.minimumNumber+' from type "'+ct+'"'+o+".");for(var ut,mt=0,yt=a(Ye[ct]);!(ut=yt()).done;){var dt,ft,ht=ut.value;null!=(dt=pt.fileName)&&dt.regularExpressionPattern&&!new RegExp(pt.fileName.regularExpressionPattern).test(ht)?s('AttachmentName: given attachment name "'+ht+'" doesn\'t satisfy specified regular expression pattern "'+pt.fileName.regularExpressionPattern+'" from type "'+ct+'"'+o+"."):null!=(ft=pt.fileName)&&ft.invertedRegularExpressionPattern&&new RegExp(pt.fileName.invertedRegularExpressionPattern).test(ht)?s('InvertedAttachmentName: given attachment name "'+ht+'" does satisfy specified regular expression pattern "'+pt.fileName.invertedRegularExpressionPattern+'" from type "'+ct+'"'+o+"."):!([null,void 0].includes(pt.contentTypeRegularExpressionPattern)||Re[ht].content_type&&new RegExp(pt.contentTypeRegularExpressionPattern).test(Re[ht].content_type))&&s('AttachmentContentType: given attachment content type "'+Re[ht].content_type+'" doesn\'t satisfy specified regular expression pattern "'+pt.contentTypeRegularExpressionPattern+'" from type "'+ct+'"'+o+".");var gt=pt.invertedContentTypeRegularExpressionPattern;[null,void 0].includes(gt)||Re[ht].content_type&&!new RegExp(gt).test(Re[ht].content_type)||s('InvertedAttachmentContentType: given attachment content type "'+Re[ht].content_type+'" does satisfy specified regular expression pattern "'+gt+'" from type "'+ct+'"'+o+".");var vt=0;"length"in Re[ht]?vt=Re[ht].length:"data"in Re[ht]&&(vt=Buffer&&"byteLength"in Buffer?Buffer.byteLength(Re[ht].data,"base64"):Re[ht].data.length),![null,void 0].includes(pt.minimumSize)&&pt.minimumSize>vt?s("AttachmentMinimumSize: given attachment size "+vt+" byte doesn't satisfy specified minimum of "+pt.minimumSize+" byte "+o+"."):![null,void 0].includes(pt.maximumSize)&&pt.maximumSize<vt&&s("AttachmentMaximumSize: given attachment size "+vt+" byte doesn't satisfy specified maximum of "+pt.maximumSize+" byte "+o+"."),mt+=vt}![null,void 0].includes(pt.minimumAggregatedSize)&&pt.minimumAggregatedSize>mt?s('AttachmentAggregatedMinimumSize: given aggregated size of attachments from type "'+ct+'" '+mt+" byte doesn't satisfy specified minimum of "+pt.minimumAggregatedSize+" byte "+o+"."):![null,void 0].includes(pt.maximumAggregatedSize)&&pt.maximumAggregatedSize<mt&&s('AttachmentAggregatedMaximumSize: given aggregated size of attachments from type "'+ct+'" '+mt+" byte doesn't satisfy specified maximum of "+pt.maximumAggregatedSize+" byte "+o+"."),at+=mt}}Object.prototype.hasOwnProperty.call(m,d.minimumAggregatedSize)&&![null,void 0].includes(m[d.minimumAggregatedSize])&&m[d.minimumAggregatedSize]>at?s("AggregatedMinimumSize: given aggregated size "+at+" byte doesn't satisfy specified minimum of "+m[d.minimumAggregatedSize]+" byte "+o+"."):![null,void 0].includes(m[d.maximumAggregatedSize])&&m[d.maximumAggregatedSize]<at&&s("AggregatedMaximumSize: given aggregated size "+at+" byte doesn't satisfy specified maximum of "+m[d.maximumAggregatedSize]+" byte "+o+".")}if(r&&Object.prototype.hasOwnProperty.call(r,d.attachment)&&0===Object.keys(r[d.attachment]).length&&delete r[d.attachment],0===i.length&&r&&"migrate"===w)for(var Ot,bt=0,wt=Object.keys(r);bt<wt.length;bt++)Ot=wt[bt],Object.prototype.hasOwnProperty.call(e,Ot)||(i=n.concat(Ot,"migrate removed property"));return{changedPath:i,newDocument:e}},I={attachmentWithPrefixExists:function(t){if(Object.prototype.hasOwnProperty.call(e,d.attachment)){var r=e[d.attachment],n=_(t);if(n)return Object.prototype.hasOwnProperty.call(r[n],"stub")&&r[n].stub||Object.prototype.hasOwnProperty.call(r[n],"data")&&![null,void 0].includes(r[n].data)}return!1},checkDocument:L,getFileNameByPrefix:_,serialize:z,id:v,revision:O,idName:f,revisionName:h,specialNames:d,typeName:g,modelConfiguration:l,models:c,now:u,nowUTCTimestamp:m,securitySettings:i,userContext:n},W=L(e,r);return(!W.newDocument._deleted||r)&&(W.newDocument._deleted&&W.newDocument._deleted!==(null==r?void 0:r._deleted)||W.changedPath.length)||s("NoChange: No new data given. new document: "+z(e)+"; old document: "+z(r)+"."),Object.prototype.hasOwnProperty.call(i,l.property.name.validatedDocumentsCache)?i[l.property.name.validatedDocumentsCache].add(v+"-"+O):i[l.property.name.validatedDocumentsCache]=new Set([v+"-"+O]),W.newDocument},e}(),s=p;e.exports=c}()}],t={};var r=function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}(0);module.exports=r})();